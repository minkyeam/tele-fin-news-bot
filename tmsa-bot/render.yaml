services:
  - type: worker
    name: tmsa-bot
    runtime: python
    buildCommand: pip install -r requirements.txt
    startCommand: python main.py --listen
    envVars:
      # ── Telegram API (수집용) ──────────────────────────────────────────
      - key: TELEGRAM_API_ID
        sync: false
      - key: TELEGRAM_API_HASH
        sync: false
      - key: TG_SESSION_STRING     # generate_session.py 실행 결과 붙여넣기
        sync: false

      # ── Telegram Bot (전송용) ──────────────────────────────────────────
      - key: TELEGRAM_BOT_TOKEN
        sync: false
      - key: TELEGRAM_TARGET_CHAT
        sync: false

      # ── Gemini API ────────────────────────────────────────────────────
      - key: GEMINI_API_KEY
        sync: false

      # ── Pipeline 파라미터 (선택) ───────────────────────────────────────
      - key: COLLECT_HOURS
        value: "24"
      - key: TOP_SIGNALS
        value: "15"
      - key: AUTO_RUN_HOURS        # 자동 실행 주기 (시간). 0이면 비활성화
        value: "8"
      - key: CHANNEL_LIST          # 쉼표 구분 채널 목록 (@ 없이)
        sync: false
      - key: DBSCAN_EPS
        value: "0.55"
      - key: DBSCAN_MIN_SAMPLES
        value: "2"
